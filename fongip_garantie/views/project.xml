<odoo>
  <data>
    <!-- ************Banques ****************** -->

    <record model="ir.actions.act_window" id="garantie_res_bank_action">
      <field name="name">Banque</field>
      <field name="res_model">res.bank</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer une nouvelle banque.
        </p>
      </field>
    </record>
    
    <!--     Reseaux                                                 -->
    <record id="fongip_reseau_view_form" model="ir.ui.view">
      <field name="name">fongip.reseau.form</field>
      <field name="model">fongip.reseau</field>
      <field name="arch" type="xml">
        <form string="Réseau">
          <sheet>
              <group>
                <field name="name"/>
              </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_reseau_view_tree" model="ir.ui.view">
      <field name="name">fongip.reseau.tree</field>
      <field name="model">fongip.reseau</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
        </tree>
      </field>
    </record>
    <!-- actions opening views on models -->
    
    <record model="ir.actions.act_window" id="fongip_reseau_action">
      <field name="name">Réseau</field>
      <field name="res_model">fongip.reseau</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer un nouveau réseau.
        </p>
      </field>
    </record>

    <!-- Fongip immobilisation -->
    <!--record id="fongip_immobilisation_view_form" model="ir.ui.view">
      <field name="name">fongip.immobilisation.form</field>
      <field name="model">fongip.immobilisation</field>
      <field name="arch" type="xml">
        <form string="Immobilisations">
          <sheet>
            <group col="2">
              <group>
                <field name="label"/>
                <field name="value"/>
              </group>
              <group>
                <field name="type_immobilisation"/>
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_immobilisation_view_tree" model="ir.ui.view">
      <field name="name">fongip.immobilisation.tree</field>
      <field name="model">fongip.immobilisation</field>
      <field name="arch" type="xml">
        <tree>
          <field name="label"/>
          <field name="value"/>
          <field name="type_immobilisation" />
        </tree>
      </field>
    </record-->

    <record id="fongip_project_view_form" model="ir.ui.view">
      <field name="name">fongip.project.form</field>
      <field name="model">fongip.project</field>
      <field name="arch" type="xml">
        <form string="Projet">
          <header>
            <!--button name="generate_dossier_number" type="object"
                    string="Generer N° Dossier"
                    states="draft"  
                    class="oe_highlight"
              /-->

            <!--button name="soumettre" type="object"
                    string="Soumettre"
                    states="draft"  
                    class="oe_highlight"
              />
              <button name="valider" type="object"
                    string="Valider"
                    states="submitted"  
                    class="oe_highlight"
              />
              <button name="precomiter" type="object"
                    string="Precomiter"
                    states="validated"  
                    class="oe_highlight"
              />
              <button name="cei" type="object"
                    string="Cei"
                    states="precomite"  
                    class="oe_highlight"
              />
              <button name="cgb" type="object"
                    string="Cgb"
                    states="cei"  
                    class="oe_highlight"
              />
              <button name="octroyer" type="object"
                    string="Octroyer"
                    states="cgb"  
                    class="oe_highlight"
              />
              <button name="refuser" type="object"
                    string="Refuser"
                    states="cgb"  
                    class="oe_highlight"
              /-->
              <button name="restructurer" type="object"
                    string="Restructurer"
                    attrs="{'invisible' : [('action','!=','non_restructure')]}"
                    class="oe_highlight"
              />              

            <field name="state" widget="statusbar"/>
            <field name="action" invisible="1"/>
          </header>
                    
          <sheet>
            <div class="oe_button_box" name="button_box">
                  <button name="return_action_to_open"
                        type="object"
                        class="oe_stat_button"
                        icon="fa-balance-scale"
                        context="{'xml_id':'fongip_credit_garantie_action'}"
                        help="Voir les lignes de crédits de ce dossiers">
                        <field name="credit_count" widget="statinfo" string="Crédits"/>
                  </button>
                  <button name="return_action_to_open"
                        type="object"
                        class="oe_stat_button"
                        help="Montant total du crédit"
                        >
                        <field name="montant_total_credit"  string="Total crédit"/>
                  </button>
                  <button name="return_action_to_open"
                      type="object"
                      class="oe_stat_button"
                      help="Montant total de la garantie"
                      >
                      <field name="montant_total_garantie" string="Total garantie"/>
                  </button>
                  <button name="open_project_before_restructured"
                        type="object"
                        attrs="{'invisible': [('action','!=','restructure')]}"
                        class="oe_stat_button"
                        icon="fa-archive"
                        context="{'xml_id':'fongip_project_actions'}"
                        help="Voir le dossier avant la restructuration">Voir
                  </button>
                  <!--button name="update_entreprise"
                        type="object"
                                
                        class="oe_stat_button"
                  /-->
                  <field name="credit_count" widget="statinfo" string="Crédits"/>
            </div>

            <group col="2">
              <group>
                <!--field name="imputation_id" invisible="1"/-->
                <field name="project_type"/>
                <field name="product_type"/>
                <field name="guarantee_type"/>
                <field name="cgb_date"/>
                <!--field name="numero_dossier"/-->
                <field name="currency_id" invisible="1"/>
                <field name="action"/>
                <field name="funding_amount" options="{'currency_field': 'currency_id'}"/>
              </group>
              <group>
                <!--field name="action"/-->
                <field name="reseau_id"/>
                <field name="bank_id"/>
                <!--field name="numero_dossier_banque"/>
                <field name="date_de_transmission"/>
                <field name="date_octroi_garantie" attrs="{'invisible':[('state','!=','octroye')]}"/-->
              </group>
            </group>
            <notebook>
              <page string= "Entreprise ou projet">
                <group col="2">
                  <group>
                    <field name="name"/>
                    <field name="numero_dossier"/>
                    <!--field name="activity_sector_id"/-->
                    <field name="produits"/>
                  </group>
                  <group>
                    <field name="partner_id" domain="[('is_company','=', True)]" context="{'default_is_company': True}"/>
                    <!--field name="filiere_id" domain="[('sector_id','=',activity_sector_id)]"/-->
                    <!--field name="pays_id"/-->
                    <field name="region_id"/>
                    <field name="departement_id" domain="[('region_id','=',region_id)]"/>
                  </group>
                </group>
                <group string="Nombre d'emplois" col="2">
                  <group>
                  </group>
                  <group>
                    <field name="number_of_jobs"/>
                  </group>
                </group>
              </page>
              
              <page string="Crédits">
                <group>
                  <field name="credit_ids"  nolabel="1">
                    </field>
                </group>
                
              </page>
            </notebook>
          </sheet>
          <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>

    <!--record id="view_fongip_project_search" model="ir.ui.view">
      <field name="name">fongip.project.search</field>
      <field name="model">fongip.project</field>
      <field name="arch" type="xml">
        <search string="Rechercher de dossiers">
          <field name="partner_id" string="Entreprises"/>
                    <field name="name" string="Nom du dossier"/>
                    <field name="project_type" string="Situation de l'entreprise"/>
                    <field name="type_produit" string="Type de produit"/>
                    <field name="date_de_transmission" string="Date de transmission"/>
                    <field name="reseau_id"/>
                    <field name="action"/>
                    <field name="state"/>
                    <group expand="0" string="Group By...">
                        <filter string="Situation de l'entreprise" icon="terp-partner" domain="[]" context="{'group_by':'project_type'}"/>
                        <filter string="Entreprise" icon="terp-personal" domain="[]"  context="{'group_by':'partner_id'}"/>
                        <filter string="Banque" icon="terp-folder-orange" domain="[]" context="{'group_by':'banque_id'}"/>
                        <filter string="Réseau" icon="terp-folder-orange" domain="[]" context="{'group_by':'reseau_id'}"/>
                        <filter string="Date de transmission" icon="terp-go-month" domain="[]" context="{'group_by':'date_de_transmission'}"/>
                    </group>
        </search>
      </field>
      
    </record-->
    
    <record id="fongip_project_view_tree" model="ir.ui.view">
      <field name="name">fongip.project.tree</field>
      <field name="model">fongip.project</field>
      <field name="arch" type="xml">
        <tree>
          <!--field name="numero_dossier"/-->
          <field name="name"/>
          <field name="partner_id"/>
          <field name="reseau_id"/>
          <field name="guarantee_type"/>
          <!--field name="activity_sector_id"/>
          <field name="filiere_id"/-->
          <field name="funding_amount"/>
          <field name="total_credit_amount" sum="Total"/>
          <field name="total_guarantee_amount" sum="Total"/>
          <!--field name="project_type"/-->
          <field name="product_type" />
        </tree>
      </field>
    </record>


    <record model="ir.actions.act_window" id="fongip_project_actions">
      <field name="name">Projet</field>
      <field name="res_model">fongip.project</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action','!=','archive')]</field>
      <field name="view_id" ref="fongip_project_view_tree"/>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer un nouveau projet.
        </p>
      </field>
    </record>

    <record model="ir.actions.act_window" id="dossiers_archives_action">
      <field name="name">Dossiers archivés</field>
      <field name="res_model">fongip.project</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action','=','archive')]</field>
      <field name="view_id" ref="fongip_project_view_tree"/>
    </record>

    <record model="ir.actions.act_window" id="dossiers_restructures_action">
      <field name="name">Dossiers restructurés</field>
      <field name="res_model">fongip.project</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action','=','restructure')]</field>
      <field name="view_id" ref="fongip_project_view_tree"/>
    </record>

     

    
    
    <!-- Top menu item -->

    <!--  groups="group_dre,group_analyste" -->
    
    <menuitem name="Garantie"
              id="menu_root"
              web_icon="fongip_garantie,static/description/icon.png"

      />
    
    <!-- menu categories -->
  
    <menuitem 
              name="Dossiers" 
              id="garantie_menu" 
              parent="menu_root"
              sequence="10"
              />
    <!--menuitem 
              name="Imputations" 
              id="garantie_menu_imputation" 
              parent="menu_root"
              sequence="30"
              /-->
    <menuitem 
              name="Tous les dossiers" 
              id="dossiers_menu"
              parent="garantie_menu"
              action="fongip_project_actions"
              sequence="10"
              />
    <menuitem 
              name="Dossiers archivés" 
              id="dossiers_archives_menu"
              parent="garantie_menu"
              action="dossiers_archives_action"
              sequence="20"
              />
    <menuitem 
              name="Dossiers restructurés" 
              id="dossiers_restructures_menu"
              parent="garantie_menu"
              action="dossiers_restructures_action"
              sequence="30"
              />
    <!--menuitem 
              name="Dossiers restructurés" 
              id="dossiers_restructures_menu"
              parent="garantie_menu"
              action="fongip_project_restructure_action"
              sequence="20"
              /-->


    <!--menuitem 
              name="Toutes les imputations" 
              id="all_imputation_menu" 
              parent="garantie_menu_imputation"
              action="fongip_all_imputation_action"
              sequence="10"
              />
    <menuitem 
              name="Mes imputations" 
              id="my_imputation_menu" 
              parent="garantie_menu_imputation"
              action="fongip_imputation_action"
              sequence="10"
              /-->

    <!--menuitem 
              name="Suivi du portefeuille" 
              id="portefeuille_garantie_menu" 
              parent="menu_root"
              sequence="30"
              /-->
    <!--menuitem 
              name="Suivi des remboursements" 
              id="fongip_remboursement_menu" 
              parent="portefeuille_garantie_menu"
              action="fongip_remboursement_action"
              sequence="20"
              /-->
    <menuitem 
              name="Configuration" 
              id="configuration_menu" 
              parent="menu_root"
              sequence="50"
              />
    <menuitem 
              name="Banques" 
              id="banque_menu" 
              parent="configuration_menu"
              action="garantie_res_bank_action"
              sequence="50"
              />

    <menuitem 
              name="Réseaux" 
              id="reseau_menu" 
              parent="configuration_menu"
              action="fongip_reseau_action"
              sequence="35"
              />
  </data>
</odoo>