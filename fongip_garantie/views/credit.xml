<odoo>
  <data>
    <!--*************Import credits***************** -->
    <record id="financing_request_import_form" model="ir.ui.view">
      <field name="name">fongip.credit.import.form</field>
      <field name="model">fongip.credit.import</field>
      <field name="arch" type="xml">
        <form string="Import des lignes de crédits">
            <header>
                <button modifiers="{'invisible':[['state','not in',['draft']]]}"
                    name="confirm"
                    states="draft"
                    string="Confirmer"
                    type="object"
                    class="oe_highlight"
                    />
                <button modifiers="{'invisible':[['state','not in',['confirmed']]]}"
                    name="cancel"
                    states="confirm"
                    string="Annuler"
                    type="object"
                    class="oe_highlight"
                    />
                <button modifiers="{'invisible':[['state','not in',['draft']]]}"
                    name="clear_all_lines"
                    states="draft"
                    string="Effacer"
                    type="object"
                    class="oe_highlight"
                    />
                <field name="state" widget="statusbar" readonly="1"/>
          </header>
          <sheet>
            <group col="2">
              <group>
                <field name="import_date"/>
                <field name="data" filename="filename"/>
              </group>
              <group>
                <field name="imported_by"/>
                <field name="individuel_guarantee"/>
                <field name="wallet_guarantee"/>
              </group>
            </group>
            <notebook>
              <page string = "Lignes de crédits">
                <field name="credit_import_line_ids">
                  <tree>
                    <field name="guarantee_type"/>
                    <field name="date_cgb"/>
                    <field name="bank_name"/>
                    <field name="mise_en_place"/>
                    <field name="date_mise_en_place"/>
                    <field name="first_due_date"/>
                    <field name="last_due_date"/>
                    <field name="project_name"/>
                    <field name="nature_credit_name"/>
                    <field name="legal_status_name"/>
                    <field name="sous_fonds_name"/>
                    <field name="product_type"/>
                    <field name="psp_name"/>
                    <field name="activity_sector_name"/>
                    <field name="filiere_name"/>
                    <field name="reseau_name"/>
                    <field name="region_name"/>
                    <field name="departement_name"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="funding_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="credit_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="guarantee_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="quota"/>
                    <field name="interest_rate"/>
                    <field name="duration"/>
                    <field name="diferred"/>
                    <field name="gurantee_commission_rate"/>
                    <field name="gurantee_commission_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="number_jobs"/>
                    <field name="payment_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="oustanding_credit" options="{'currency_field': 'currency_id'}"/>
                    <field name="oustanding_guarantee" options="{'currency_field': 'currency_id'}"/>
                    <field name="status_name"/>
                    <field name="nombre_echeances_impayes"/>
                    <field name="unpaid_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="compensation_amount" options="{'currency_field': 'currency_id'}"/>
                    <field name="observations"/>
                    <field name="code"/>
                    <field name="country"/>
                    <field name="code_benef"/>

                  </tree>
                </field>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_credit_import_tree" model="ir.ui.view">
      <field name="name">fongip.credit.import.tree</field>
      <field name="model">fongip.credit.import</field>
      <field name="arch" type="xml">
        <tree>
          <field name="import_date"/>
          <field name="imported_by"/>
        </tree>
      </field>
    </record>
    <!-- actions opening views on models -->
    
    <record model="ir.actions.act_window" id="fongip_credit_import_action">
      <field name="name">Import lignes de crédits</field>
      <field name="res_model">fongip.credit.import</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour importer 
        </p>
      </field>
    </record>
    <!--  Fongip nature de credit                                              -->
      <record id="fongip_credit_nature_view_form" model="ir.ui.view">
      <field name="name">fongip.credit.nature.form</field>
      <field name="model">fongip.credit.nature</field>
      <field name="arch" type="xml">
        <form string="Nature du crédit">
          <sheet>
              <group>
                <field name="name"/>
              </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_nature_credit_view_tree" model="ir.ui.view">
      <field name="name">fongip.credit.nature.tree</field>
      <field name="model">fongip.credit.nature</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
        </tree>
      </field>
    </record>
    <!-- actions opening views on models -->
    
    <record model="ir.actions.act_window" id="fongip_nature_credit_action">
      <field name="name">Nature de crédit</field>
      <field name="res_model">fongip.credit.nature</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer une nouvelle nature de crédit.
        </p>
      </field>
    </record>

    <!--     Fongip etat credit                                                 -->
    <record id="fongip_credit_status_view_form" model="ir.ui.view">
      <field name="name">fongip.credit.status.form</field>
      <field name="model">fongip.credit.status</field>
      <field name="arch" type="xml">
        <form string="Etat du crédit">
          <sheet>
              <group>
                <field name="name"/>
              </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_credit_status_view_tree" model="ir.ui.view">
      <field name="name">fongip.credit.status.tree</field>
      <field name="model">fongip.credit.status</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
        </tree>
      </field>
    </record>
    <!-- actions opening views on models -->
    
    <record model="ir.actions.act_window" id="fongip_credit_status_action">
      <field name="name">Etat du crédit</field>
      <field name="res_model">fongip.credit.status</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer un nouveau etat de crédit.
        </p>
      </field>
    </record>
    <!-- Credits garantie                                                           -->
    <record id="fongip_credit_garantie_view_form" model="ir.ui.view">
      <field name="name">fongip.credit.form</field>
      <field name="model">fongip.credit</field>
      <field name="arch" type="xml">
        <form string="Credits">
          <header>
              <button name="compute_commission"
                    type="object"
                    string="Calculer les commissions"
                    class="oe_highlight"
              />
              <!--button name="generer_tableau_amortissement"
                    type="object"
                    string="Générer tableau amortissement"
                    class="oe_highlight"
                    attrs="{'invisible':[('amortissable','=',False)]}"
              />
              <button name="update_tableau_amortissement"
                    type="object"
                    string="Mettre à jour le tableau amortissement"
                    class="oe_highlight"
                    attrs="{'invisible':[('amortissable','=',False)]}"
              /-->
            </header>
          <sheet>
            <div class="oe_button_box" name="button_box">
                            <button name="return_action_to_open"
                                type="object"
                                class="oe_stat_button"
                                context="{'xml_id':'fongip_commission_action'}"
                                help="Voir les commissions">
                                <field name="montant_commission"  string="Commission en TTC"/>
                            </button>

                            <!--button name="return_action_to_open"
                                type="object"
                                class="oe_stat_button"
                                icon="fa-book"
                                context="{'xml_id':'fongip_credit_impaye_action'}"
                                help="Voir les impayes de cette ligne de credits">
                                <field name="nombre_echeances_impayes" widget="statinfo" string="Impayes"/>
                            </button>
                            <button name="return_action_to_open"
                                type="object"
                                class="oe_stat_button"
                                context="{'xml_id':'fongip_credit_impaye_action'}"
                                help="Voir les impayes de cette ligne de credits"
                                >
                                <field name="montant_impayes"  string="Total impayé"/>
                            </button-->
                        </div>
            <group col="2">
              <group>
                <field name="description"/>
                <field name="bank_id"/>
                <field name="nature_credit_id"/>
                <field name="mise_en_place"/>
                <field name="duration"/>
                <field name="interest_rate"/>
                <field name="currency_id" invisible="1"/>
                <field name="amount" options="{'currency_field': 'currency_id'}"/>
                <!--field name="montant_financement"/-->
                <field name="state"/>
                <field name="amortissable"/>
                <field name="diferred" attrs="{'invisible':[('amortissable','=',False)]}"/>
                <field name="diferred_duration" attrs="{'invisible':['|',('amortissable','=',False),('diferred','=',False)]}"/>
                <field name="type_remboursement"/>
              </group>
              <group>
                <!--field name="type_garantie"/-->
                <field name="quota"/>
                <field name="guarantee_amount" options="{'currency_field': 'currency_id'}"/>
                <field name="first_due_date"/>
                <field name="payment_amount" options="{'currency_field': 'currency_id'}"/>
                <field name="gurantee_commission_amount" options="{'currency_field': 'currency_id'}"/>
                <field name="gurantee_commission_rate"/>
                <field name="action"/>
                <!--field name="nombre_echeances_impayes"/>
                <field name="montant_impayes"/-->
                <field name="project_id"/>
                
              </group>
              <!--group col="4" colspan="4" string="Tableau amortissement">
                  <field name="amortissement_line_ids" nolabel="1"/-->
            </group>
            </group>
            
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_credit_garantie_view_tree" model="ir.ui.view">
      <field name="name">fongip.credit.tree</field>
      <field name="model">fongip.credit</field>
      <field name="arch" type="xml">
        <tree>
          <field name="description"/>
          <!--field name="type_garantie"/-->
          <field name="bank_id"/>
          <field name="nature_credit_id"/>
          <field name="duration"/>
          <field name="amount" sum="Total"/>
          <field name="quota"/>
          <field name="guarantee_amount" sum="Total"/>
          <field name="oustanding_credit" sum="Total"/>
          <field name="oustanding_guarantee" sum="Total"/>
          <field name="state"/>
          <!--field name="etat_credit_name" invisible="1"/>
          <button 
                    name="annuler" 
                    type="object"
                    string="Annuler"
                    attrs="{'invisible': [('etat_credit_name','!=','Non mis en place')]}"
          />
          <button 
                    name="declasser" 
                    type="object"
                    string="Déclasser"
                    attrs="{'invisible': [('etat_credit_name','!=','Impayé')]}"
                /-->
        </tree>
      </field>
    </record>
    <!-- actions opening views on models -->
    
    <record model="ir.actions.act_window" id="fongip_credit_garantie_action">
      <field name="name">Credit garantie</field>
      <field name="res_model">fongip.credit</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action','!=','archive')]</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer un nouveau credit.
        </p>
      </field>
    </record>

    <!--record id="view_fongip_credit_garantie_search" model="ir.ui.view">
      <field name="name">fongip.credit.search</field>
      <field name="model">fongip.credit</field>
      <field name="arch" type="xml">
        <search string="">
          <field name="description" string="Nom"/>
          <field name="project_id" string="Dossier"/>   
          <field name="origine_credit" string="Banque"/>
          <field name="type_credit_id" string="Nature du crédit"/>
          <field name="sous_fond_id" string="Sous fond"/>
          <field name="etat_credit_id" string="Etat du crédit"/>
            <group expand="0" string="Group By...">
              <filter string="Banques" icon="terp-partner" domain="[]" context="{'group_by':'origine_credit'}"/>
              <filter string="Dossier" icon="terp-personal" domain="[]"  context="{'group_by':'project_id'}"/>
              <filter string="Nature du crédit" icon="terp-folder-orange" domain="[]" context="{'group_by':'type_credit_id'}"/>
              <filter string="Sous fond" icon="terp-stock_effects-object-coorize" domain="[]"  context="{'group_by':'sous_fond_id'}"/>
              <filter string="Etat du crédit" icon="terp-stock_effects-object-coorize" domain="[]"  context="{'group_by':'etat_credit_id'}"/>
              <filter string="Mise en place" icon="terp-stock_effects-object-coorize" domain="[]"  context="{'group_by':'mise_en_place'}"/>
            </group>
        </search>
      </field>
    </record-->

    <!--********************Begin Gestion des impayes****************** -->
    <!--record id="fongip_credit_impaye_view_form" model="ir.ui.view">
      <field name="name">fongip.credit.impaye.form</field>
      <field name="model">fongip.credit.impaye</field>
      <field name="arch" type="xml">
        <form string="Déclaration d'un impayé">
          <header>
            <button name="regulariser" type="object"
                    string="Régulariser"
                    states="non_regularise"  
                    class="oe_highlight"
              />
              <field name="state" widget="statusbar"/>
          </header>
          <sheet>
            <group col="2">
              <group>
                <field name="echeance"/>
                <field name="currency_id" invisible="1"/>
                <field name="capital_debut_periode" options="{'currency_field': 'currency_id'}"/>
                <field name="interet" options="{'currency_field': 'currency_id'}"/>
                <field name="annuite" options="{'currency_field': 'currency_id'}"/>
                
              </group>
              <group>
                
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_credit_impaye_view_tree" model="ir.ui.view">
      <field name="name">fongip.credit.impaye.tree</field>
      <field name="model">fongip.credit.impaye</field>
      <field name="arch" type="xml">
        <tree delete="false" edit="false" create="false">
          <field name="echeance"/>
          <field name="capital_debut_periode"/>
          <field name="interet"/>
          <field name="annuite"/>
          <field name="state"/>
          <field name="date_regularisation"/>
        </tree>
      </field>
    </record>
    
    <record model="ir.actions.act_window" id="fongip_credit_impaye_action">
      <field name="name">Impayes</field>
      <field name="res_model">fongip.credit.impaye</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour déclarer un impayé.
        </p>
      </field>
    </record-->

    <!--********************End Gestion des impayes ******************* -->
    <!-- ***************Remboursements*************** -->
    <!--record id="fongip_encaissement_view_form" model="ir.ui.view">
      <field name="name">fongip.encaissement.form</field>
      <field name="model">fongip.encaissement</field>
      <field name="arch" type="xml">
        <form string="Remboursement">
          <sheet>
            <group col="2">
              <group>
                <field name="entreprise_id"/>
                <field name="project_id" domain="[('entreprise_id','=',entreprise_id),('action','!=','archive')]"/>
                <field name="credit_garantie_id" domain="[('project_id','=',project_id)]"/>
              </group>
              <group>
                <field name="date_paiement"/>
                <field name="currency_id" invisible="1"/>
                <field name="montant" options="{'currency_field': 'currency_id'}"/>
                <field name="observations"/>
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="fongip_encaissement_view_tree" model="ir.ui.view">
      <field name="name">fongip.encaissement.tree</field>
      <field name="model">fongip.encaissement</field>
      <field name="arch" type="xml">
        <tree>
          <field name="credit_garantie_id"/>
          <field name="date_paiement"/>
          <field name="montant" />
          <field name="observations"/>
        </tree>
      </field>
    </record>

    <record model="ir.actions.act_window" id="fongip_remboursement_action">
      <field name="name">Remboursements</field>
      <field name="res_model">fongip.encaissement</field>
      <field name="view_mode">tree,form</field>
      <field name="help" type="xml">
        <p class="oe_view_nocontent_create">
          Cliquer pour enregistrer un remboursement.
        </p>
      </field>
    </record-->
    <!-- *************** tableau d'amortissement ************* -->
    <!--record id="fongip_amortissement_line_view_tree" model="ir.ui.view">
      <field name="name">fongip.amortissement.line.tree</field>
      <field name="model">fongip.amortissement.line</field>
      <field name="arch" type="xml">
        <tree string="Tableau d'amortissement" editable="bottom" delete="false">
          <field name="numero"/>
          <field name="echeance"/>
          <field name="annuite" />
          <field name="capital_rembourse" sum="Total capital remboursé"/>
          <field name="interet"/>
          <field name="capital_fin_periode"/>
          <field name="engagement_garantie"/>
          <field name="commission_garantie" sum="Total commission garantie"/>
          <field name="status"/>
          <button 
                    name="payer" 
                    type="object"
                    string="Payé"
                    attrs="{'invisible': [('status','=','paye')]}"
                />
          <button 
                    name="impayer" 
                    type="object"
                    string="Impayé"
                    attrs="{'invisible': ['|',('status','=','paye'),('status','=','impaye')]}"
                />
        </tree>
      </field>
    </record-->

<!--  groups="group_dre,group_analyste" -->
    <menuitem 
              name="Crédits de garantie" 
              id="credit_garantie_menu" 
              parent="menu_root"
              sequence="20"
              
              />
    <menuitem 
              name="Liste des credits de garantie" 
              id="liste_credits_garantie_menu" 
              parent="credit_garantie_menu"
              action="fongip_credit_garantie_action"
              sequence="10"
              
              />
    <!--menuitem 
              name="Les impayés" 
              id="fongip_credit_impaye_menu" 
              parent="credit_garantie_menu"
              action="fongip_credit_impaye_action"
              sequence="20"
              /-->


    <menuitem 
              name="Nature crédit" 
              id="credit_status_menu" 
              parent="configuration_menu"
              action="fongip_credit_status_action"
              sequence="32"
              /> 
    <!--menuitem 
              name="Etat du crédit" 
              id="etat_credit_menu" 
              parent="configuration_menu"
              action="fongip_etat_credit_action"
              sequence="33"
              /-->
  </data>
</odoo>